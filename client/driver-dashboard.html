<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver Portal - MarketPace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a0b3d 0%, #2d1b69 50%, #1a0b3d 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .driver-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .driver-status {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #1a0b3d;
            border-radius: 25px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .driver-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 5px;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .route-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .route-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .route-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .route-id {
            font-weight: bold;
            color: #00ffff;
        }

        .route-earnings {
            font-weight: bold;
            color: #00ff88;
        }

        .route-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-available {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #1a0b3d;
        }

        .status-in-progress {
            background: linear-gradient(45deg, #ffd700, #ffb300);
            color: #1a0b3d;
        }

        .status-completed {
            background: linear-gradient(45deg, #4169e1, #0066ff);
            color: white;
        }

        .delivery-list {
            display: grid;
            gap: 10px;
        }

        .delivery-item {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #00ffff;
            display: flex;
            justify-content: between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .delivery-info h4 {
            color: #00ffff;
            margin-bottom: 5px;
        }

        .delivery-info p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin: 2px 0;
        }

        .delivery-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #1a0b3d;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #4169e1, #0066ff);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffd700, #ffb300);
            color: #1a0b3d;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.3);
        }

        .qr-scanner {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .qr-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #00ffff, #0066ff);
            border-radius: 15px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: rgba(255, 255, 255, 0.6);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .time-slot-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .time-slot {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-slot.available {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }

        .time-slot.selected {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.2);
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 15px;
            }
            
            .driver-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .route-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .delivery-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Driver Header -->
        <div class="driver-header">
            <div style="text-align: left; margin-bottom: 20px;">
                <button onclick="goToMenu()" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px;">‚Üê Back to Menu</button>
            </div>
            <div class="driver-status">üöó APPROVED DRIVER</div>
            <h1 id="driverWelcome">Driver Portal</h1>
            <p>Manage routes, scan QR codes, track earnings</p>
            <p style="color: rgba(255,255,255,0.7); font-size: 14px; margin-top: 10px;">Access through your personalized MarketPace menu portal</p>
        </div>

        <!-- Driver Stats -->
        <div class="driver-stats">
            <div class="stat-card">
                <div class="stat-number">47</div>
                <div class="stat-label">Deliveries Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">$142.50</div>
                <div class="stat-label">Earnings Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4.9</div>
                <div class="stat-label">Rating</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">8</div>
                <div class="stat-label">Available Routes</div>
            </div>
        </div>

        <!-- QR Scanner Section -->
        <div class="route-section">
            <h2 class="section-title">üì± QR Code Scanner</h2>
            <div class="qr-scanner">
                <div class="qr-icon">
                    <svg width="30" height="30" fill="white" viewBox="0 0 24 24">
                        <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zM3 21h8v-8H3v8zm2-6h4v4H5v-4zM13 3v8h8V3h-8zm6 6h-4V5h4v4zM19 13h-2v2h2v-2zM19 17h-2v2h2v-2zM17 15h-2v2h2v-2zM15 13h-2v2h2v-2zM21 15h-2v2h2v-2zM21 19h-2v2h2v-2z"/>
                    </svg>
                </div>
                <h3>Scan QR Codes for Pickup & Return</h3>
                <p>Use your phone camera to scan customer QR codes for instant confirmation</p>
                <button class="btn btn-primary" onclick="openQRScanner()">üì± Open Scanner</button>
            </div>
        </div>

        <!-- Time Slot Selection -->
        <div class="route-section">
            <h2 class="section-title">‚è∞ Select Your Time Slots</h2>
            <div class="time-slot-selector">
                <div class="time-slot available" onclick="selectTimeSlot(this, '9am-12pm')">
                    <h3>9:00 AM - 12:00 PM</h3>
                    <p>6 routes available</p>
                    <small>Max earnings: $78</small>
                </div>
                <div class="time-slot available" onclick="selectTimeSlot(this, '12pm-3pm')">
                    <h3>12:00 PM - 3:00 PM</h3>
                    <p>8 routes available</p>
                    <small>Max earnings: $104</small>
                </div>
                <div class="time-slot available" onclick="selectTimeSlot(this, '3pm-6pm')">
                    <h3>3:00 PM - 6:00 PM</h3>
                    <p>12 routes available</p>
                    <small>Max earnings: $156</small>
                </div>
                <div class="time-slot available" onclick="selectTimeSlot(this, '6pm-9pm')">
                    <h3>6:00 PM - 9:00 PM</h3>
                    <p>4 routes available</p>
                    <small>Max earnings: $52</small>
                </div>
            </div>
        </div>

        <!-- Available Routes -->
        <div class="route-section">
            <h2 class="section-title">üõ£Ô∏è Available Routes</h2>
            
            <div class="route-card">
                <div class="route-header">
                    <div>
                        <span class="route-id">Route #MP-2025-A47</span>
                        <span class="route-earnings">$36.50 estimated</span>
                    </div>
                    <span class="route-status status-available">Available</span>
                </div>
                <div class="delivery-list">
                    <div class="delivery-item">
                        <div class="delivery-info">
                            <h4>Power Washer Pickup</h4>
                            <p>üìç 123 Beach Blvd ‚Üí 456 Gulf Shore Dr</p>
                            <p>‚è∞ 2:00 PM - 2:30 PM ‚Ä¢ üéØ QR Scan Required</p>
                        </div>
                        <div class="delivery-actions">
                            <button class="btn btn-primary" onclick="acceptRoute('MP-2025-A47')">Accept Route</button>
                        </div>
                    </div>
                    <div class="delivery-item">
                        <div class="delivery-info">
                            <h4>Camera Kit Return</h4>
                            <p>üìç 456 Gulf Shore Dr ‚Üí 789 Coastal Ave</p>
                            <p>‚è∞ 2:45 PM - 3:15 PM ‚Ä¢ üéØ QR Scan Required</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="route-card">
                <div class="route-header">
                    <div>
                        <span class="route-id">Route #MP-2025-B23</span>
                        <span class="route-earnings">$28.00 estimated</span>
                    </div>
                    <span class="route-status status-available">Available</span>
                </div>
                <div class="delivery-list">
                    <div class="delivery-item">
                        <div class="delivery-info">
                            <h4>Professional Tools Delivery</h4>
                            <p>üìç Gulf Shores Hardware ‚Üí 321 Marina Way</p>
                            <p>‚è∞ 3:30 PM - 4:00 PM ‚Ä¢ üéØ QR Scan Required</p>
                        </div>
                        <div class="delivery-actions">
                            <button class="btn btn-primary" onclick="acceptRoute('MP-2025-B23')">Accept Route</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Active Routes -->
        <div class="route-section">
            <h2 class="section-title">üöó Your Active Routes</h2>
            
            <div class="route-card">
                <div class="route-header">
                    <div>
                        <span class="route-id">Route #MP-2025-C15</span>
                        <span class="route-earnings">$42.50</span>
                    </div>
                    <span class="route-status status-in-progress">In Progress</span>
                </div>
                <div class="delivery-list">
                    <div class="delivery-item" style="border-left-color: #ffd700;">
                        <div class="delivery-info">
                            <h4>Tent & Camping Gear Pickup</h4>
                            <p>üìç 555 Adventure Ave ‚Ä¢ Customer: Sarah M.</p>
                            <p>‚è∞ Next Stop ‚Ä¢ üì± (251) 555-0123</p>
                            <p><strong>üéØ Ready for QR Scan Pickup</strong></p>
                        </div>
                        <div class="delivery-actions">
                            <button class="btn btn-warning" onclick="openQRScanner('pickup')">üì± Scan QR Code</button>
                            <button class="btn btn-secondary" onclick="openGeoQRSelector('pickup')">üìç Generate Geo QR</button>
                            <button class="btn btn-secondary" onclick="callCustomer('2515550123')">üìû Call</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Completed Today -->
        <div class="route-section">
            <h2 class="section-title">‚úÖ Completed Today</h2>
            
            <div class="route-card">
                <div class="route-header">
                    <div>
                        <span class="route-id">Route #MP-2025-D08</span>
                        <span class="route-earnings">$31.25 earned</span>
                    </div>
                    <span class="route-status status-completed">Completed</span>
                </div>
                <div class="delivery-list">
                    <div class="delivery-item" style="border-left-color: #4169e1;">
                        <div class="delivery-info">
                            <h4>Party Equipment Return</h4>
                            <p>üìç Completed at 1:45 PM</p>
                            <p>‚≠ê 5-star rating ‚Ä¢ $5.00 tip received</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="btn btn-secondary" onclick="viewEarnings()">üí∞ View Earnings</button>
            <button class="btn btn-primary" onclick="updateAvailability()">üìÖ Update Availability</button>
            <button class="btn btn-secondary" onclick="contactSupport()">üÜò Driver Support</button>
        </div>
    </div>

    <script>
        // Driver Dashboard Functions
        function selectTimeSlot(element, timeSlot) {
            // Remove previous selections
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            
            // Add selection to clicked slot
            element.classList.add('selected');
            
            showNotification(`Selected time slot: ${timeSlot}`, 'success');
            
            // Simulate loading routes for selected time
            setTimeout(() => {
                showNotification(`Found ${Math.floor(Math.random() * 10) + 3} available routes for ${timeSlot}`, 'info');
            }, 1000);
        }

        function acceptRoute(routeId) {
            showNotification(`Accepting route ${routeId}...`, 'info');
            
            // Simulate route acceptance
            setTimeout(() => {
                showNotification(`Route ${routeId} accepted! Check your active routes.`, 'success');
                
                // Update UI to show accepted route
                const routeCard = document.querySelector(`[onclick="acceptRoute('${routeId}')"]`).closest('.route-card');
                if (routeCard) {
                    routeCard.style.opacity = '0.6';
                    routeCard.querySelector('.route-status').textContent = 'Accepted';
                    routeCard.querySelector('.route-status').className = 'route-status status-in-progress';
                }
            }, 1500);
        }

        function openQRScanner(type = 'general') {
            showNotification(`Opening QR scanner for ${type}...`, 'info');
            
            // In a real app, this would open the camera
            // For demo, we'll simulate a successful scan
            setTimeout(() => {
                if (type === 'pickup') {
                    showNotification('‚úÖ Pickup QR scanned successfully! Rental confirmed with customer.', 'success');
                    // Update the active route status
                    const activeRoute = document.querySelector('.status-in-progress').closest('.route-card');
                    if (activeRoute) {
                        activeRoute.querySelector('.delivery-info h4').textContent = 'Tent & Camping Gear - PICKED UP';
                        activeRoute.querySelector('.delivery-info strong').textContent = 'üéØ Ready for Delivery to Customer';
                        activeRoute.querySelector('.btn-warning').textContent = 'üì± Scan Return QR';
                        activeRoute.querySelector('.btn-warning').onclick = () => openQRScanner('return');
                    }
                } else if (type === 'return') {
                    showNotification('‚úÖ Return QR scanned successfully! Rental completed.', 'success');
                } else {
                    showNotification('‚úÖ QR code scanned successfully!', 'success');
                }
            }, 2000);
        }

        function openGeoQRSelector(type) {
            const purpose = type === 'pickup' ? 'rental_driver_pickup_owner' : 'rental_driver_return_owner';
            const relatedId = 'driver-route-' + Date.now();
            const url = `/geo-qr-selector.html?purpose=${purpose}&relatedId=${relatedId}`;
            window.open(url, '_blank', 'width=900,height=700');
            showNotification(`Opening geo QR options for ${type}...`, 'info');
        }

        function callCustomer(phoneNumber) {
            showNotification(`Calling customer at ${phoneNumber}...`, 'info');
            // In a real app, this would initiate a phone call
            window.open(`tel:${phoneNumber}`);
        }

        function viewEarnings() {
            showNotification('Loading earnings report...', 'info');
            // Navigate to earnings page
            setTimeout(() => {
                alert(`Today's Earnings Summary:
                
Base Pay: $98.50
Tips Received: $44.00
Mileage: $28.75
Total: $171.25

Weekly Total: $847.30
Monthly Total: $3,285.50`);
            }, 1000);
        }

        function updateAvailability() {
            showNotification('Opening availability settings...', 'info');
            
            setTimeout(() => {
                const availability = prompt(`Update your availability:
                
Current: Available Monday-Friday, 9 AM - 6 PM
                
Enter new availability or press Cancel to keep current:`);
                
                if (availability) {
                    showNotification('Availability updated successfully!', 'success');
                } else {
                    showNotification('Availability unchanged', 'info');
                }
            }, 500);
        }

        function contactSupport() {
            showNotification('Connecting to driver support...', 'info');
            
            setTimeout(() => {
                alert(`MarketPace Driver Support:
                
üìû Phone: (251) 555-DRIVE
üìß Email: drivers@marketpace.shop
üí¨ Live Chat: Available 6 AM - 11 PM

For emergencies during delivery:
üö® Call: (251) 555-HELP

Need help with:
- Route issues
- Payment questions  
- App problems
- Customer disputes`);
            }, 1000);
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(45deg, #00ff88, #00cc6a)' : 
                            type === 'error' ? 'linear-gradient(45deg, #ff4444, #cc0000)' : 
                            'linear-gradient(45deg, #4169e1, #0066ff)'};
                color: ${type === 'info' ? 'white' : '#1a0b3d'};
                padding: 15px 20px;
                border-radius: 10px;
                font-weight: bold;
                z-index: 1000;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                transform: translateX(100%);
                transition: all 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Slide in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Slide out and remove
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function goToMenu() {
            window.location.href = '/menu';
        }

        function checkDriverStatus() {
            // Check if user has driver status and update display
            const userProfile = JSON.parse(localStorage.getItem('marketpaceUser') || '{}');
            const driverData = localStorage.getItem('driverData');
            
            if (userProfile.driverInfo || driverData) {
                const driverInfo = userProfile.driverInfo || JSON.parse(driverData);
                if (driverInfo && driverInfo.name) {
                    document.getElementById('driverWelcome').textContent = `Welcome back, ${driverInfo.name}!`;
                }
            }
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            checkDriverStatus();
            showNotification('Driver portal loaded successfully!', 'success');
            
            // Auto-refresh data every 30 seconds
            setInterval(() => {
                console.log('Refreshing driver data...');
                // In a real app, this would fetch updated routes and stats
            }, 30000);
            
            console.log('Driver Portal page loaded - accessed through unified portal system');
        });
    </script>
</body>
</html>