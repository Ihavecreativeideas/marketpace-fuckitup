<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Public Profile | MarketPace</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a0b3d 0%, #6b46c1 50%, #2d1b69 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            padding: 15px 20px;
            z-index: 100;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 500px;
            margin: 0 auto;
        }

        .back-btn {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8A2BE2;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(138, 43, 226, 0.4);
            transform: scale(1.1);
        }

        .header-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e2e8f0;
        }

        .share-btn {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
            border-radius: 20px;
            padding: 8px 15px;
            color: #8A2BE2;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .share-btn:hover {
            background: rgba(138, 43, 226, 0.4);
        }

        /* Profile Container */
        .profile-container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Profile Header */
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8A2BE2, #FF69B4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            margin: 0 auto 15px;
            border: 3px solid rgba(255, 255, 255, 0.2);
        }

        .profile-username {
            font-size: 1.5rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .profile-bio {
            color: #a0a0a0;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .profile-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #8A2BE2;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #a0a0a0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Profile Actions */
        .profile-actions {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .action-button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #8A2BE2, #FF69B4);
            color: white;
        }

        .btn-secondary {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
            color: #8A2BE2;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.4);
        }

        /* Content Sections */
        .content-section {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(138, 43, 226, 0.2);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .section-header {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            font-weight: 600;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-content {
            padding: 20px;
        }

        /* Recent Check-ins */
        .checkin-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(138, 43, 226, 0.1);
        }

        .checkin-item:last-child {
            border-bottom: none;
        }

        .checkin-location {
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 5px;
        }

        .checkin-caption {
            color: #a0a0a0;
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 5px;
        }

        .checkin-meta {
            display: flex;
            gap: 15px;
            font-size: 0.8rem;
            color: #8A2BE2;
        }

        /* Support Tags */
        .support-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .support-tag {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
            color: #FF69B4;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #8A2BE2;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(138, 43, 226, 0.2);
            padding: 10px 0;
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 500px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .nav-item:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            color: #a0a0a0;
            font-size: 0.8rem;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .nav-label {
            font-size: 0.7rem;
            color: #a0a0a0;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <button class="back-btn" onclick="goBack()">‚Üê</button>
            <div class="header-title">Public Profile</div>
            <button class="share-btn" onclick="shareProfile()">SHARE</button>
        </div>
    </div>

    <!-- Profile Container -->
    <div class="profile-container">
        <!-- Loading State -->
        <div id="loading" class="loading">
            LOADING PROFILE...
        </div>

        <!-- Profile Content (Initially Hidden) -->
        <div id="profile-content" style="display: none;">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-avatar" id="profile-avatar">SM</div>
                <div class="profile-username" id="profile-username">SarahM</div>
                <div class="profile-bio" id="profile-bio">Coffee enthusiast & local business supporter. Love exploring new places in our community!</div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="total-checkins">47</div>
                        <div class="stat-label">Check-ins</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="businesses-supported">12</div>
                        <div class="stat-label">Supported</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="events-attended">8</div>
                        <div class="stat-label">Events</div>
                    </div>
                </div>
            </div>

            <!-- Profile Actions -->
            <div class="profile-actions">
                <button class="action-button btn-primary" onclick="followJourney()">FOLLOW JOURNEY</button>
                <button class="action-button btn-secondary" onclick="inviteToEvent()">INVITE TO EVENT</button>
            </div>

            <!-- Recent Check-ins -->
            <div class="content-section">
                <div class="section-header">
                    <span>Recent Check-ins</span>
                    <button class="share-btn" onclick="seeAllCheckins()">SEE ALL</button>
                </div>
                <div class="section-content" id="recent-checkins">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- Businesses Supported -->
            <div class="content-section">
                <div class="section-header">
                    <span>Businesses Supported</span>
                </div>
                <div class="section-content">
                    <div class="support-tags" id="supported-businesses">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Events Attended -->
            <div class="content-section">
                <div class="section-header">
                    <span>Events Attended</span>
                </div>
                <div class="section-content">
                    <div class="support-tags" id="events-attended">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-container">
            <div class="nav-item" onclick="navigateToPage('home')">
                <div class="nav-icon">HOME</div>
                <div class="nav-label">Local Pace</div>
            </div>
            <div class="nav-item" onclick="navigateToPage('market')">
                <div class="nav-icon">SHOP</div>
                <div class="nav-label">Market</div>
            </div>
            <div class="nav-item" onclick="navigateToPage('mypace')">
                <div class="nav-icon">PACE</div>
                <div class="nav-label">MyPace</div>
            </div>
            <div class="nav-item" onclick="navigateToPage('discover')">
                <div class="nav-icon">DISC</div>
                <div class="nav-label">Discover</div>
            </div>
            <div class="nav-item" onclick="navigateToPage('hub')">
                <div class="nav-icon">HUB</div>
                <div class="nav-label">MicPace</div>
            </div>
            <div class="nav-item" onclick="navigateToPage('menu')">
                <div class="nav-icon">MENU</div>
                <div class="nav-label">Menu</div>
            </div>
        </div>
    </div>

    <script>
        // Get username from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const username = urlParams.get('user') || 'unknown';

        // Load profile data
        async function loadProfile() {
            try {
                // Fetch profile from API
                const response = await fetch(`/api/mypace/profile/${username}`);
                const result = await response.json();
                
                if (result.success) {
                    displayProfile(result.profile);
                } else {
                    console.log('Profile not found, showing sample data');
                    displaySampleProfile();
                }
                
            } catch (error) {
                console.error('Error loading profile:', error);
                displaySampleProfile();
            }
            
            // Hide loading and show content
            document.getElementById('loading').style.display = 'none';
            document.getElementById('profile-content').style.display = 'block';
        }

        // Display profile data
        function displayProfile(profile) {
            document.getElementById('profile-avatar').textContent = profile.avatar;
            document.getElementById('profile-username').textContent = profile.username;
            document.getElementById('profile-bio').textContent = profile.bio;
            document.getElementById('total-checkins').textContent = profile.totalCheckins;
            document.getElementById('businesses-supported').textContent = profile.businessesSupported.length;
            document.getElementById('events-attended').textContent = profile.eventsAttended.length;
            
            // Recent check-ins
            const checkinsContainer = document.getElementById('recent-checkins');
            checkinsContainer.innerHTML = '';
            
            profile.recentCheckins.forEach(checkin => {
                const checkinDiv = document.createElement('div');
                checkinDiv.className = 'checkin-item';
                checkinDiv.innerHTML = `
                    <div style="flex: 1;">
                        <div class="checkin-location">LOC: ${checkin.locationName}</div>
                        <div class="checkin-caption">${checkin.caption}</div>
                        <div class="checkin-meta">
                            <span>${checkin.timestamp}</span>
                            <span>LIKE ${checkin.likes}</span>
                        </div>
                    </div>
                `;
                checkinsContainer.appendChild(checkinDiv);
            });
            
            // Supported businesses
            const businessesContainer = document.getElementById('supported-businesses');
            businessesContainer.innerHTML = '';
            profile.businessesSupported.forEach(business => {
                const tag = document.createElement('div');
                tag.className = 'support-tag';
                tag.textContent = business;
                businessesContainer.appendChild(tag);
            });
            
            // Events attended
            const eventsContainer = document.getElementById('events-attended');
            eventsContainer.innerHTML = '';
            profile.eventsAttended.forEach(event => {
                const tag = document.createElement('div');
                tag.className = 'support-tag';
                tag.textContent = event;
                eventsContainer.appendChild(tag);
            });
        }

        // Display sample profile for demo
        function displaySampleProfile() {
            const sampleProfile = {
                avatar: username.substring(0, 2).toUpperCase(),
                username: username,
                bio: 'MarketPace member exploring our local community!',
                totalCheckins: 25,
                businessesSupported: ['Local Coffee Shop', 'Main Street Bakery'],
                eventsAttended: ['Community Market', 'Art Walk'],
                recentCheckins: [
                    {
                        locationName: 'Local Coffee Shop',
                        caption: 'Great coffee and atmosphere!',
                        timestamp: '2 hours ago',
                        likes: 8
                    }
                ]
            };
            
            displayProfile(sampleProfile);
        }

        // Navigation functions
        function goBack() {
            window.history.back();
        }

        function shareProfile() {
            showNotification(`Sharing ${username}'s profile...`);
        }

        function followJourney() {
            showNotification(`Following ${username}'s journey!`);
        }

        function inviteToEvent() {
            showNotification(`Invite to event feature coming soon!`);
        }

        function seeAllCheckins() {
            showNotification(`Viewing all check-ins for ${username}...`);
        }

        function navigateToPage(page) {
            const routes = {
                'home': '/community.html',
                'market': '/market.html',
                'mypace': '/mypace.html',
                'discover': '/mypace-discover.html',
                'hub': '/the-hub.html',
                'menu': '/marketpace-menu.html'
            };
            
            if (routes[page]) {
                window.location.href = routes[page];
            }
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #8A2BE2, #FF69B4);
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // Initialize profile on page load
        window.addEventListener('DOMContentLoaded', loadProfile);
    </script>
</body>
</html>